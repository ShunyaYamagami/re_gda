    if config.cuda_dir == 0:
        im = input_const_values(im, resize, const_abs=False, const_pha=True, n_random = resize[0] * resize[1] // 6, const_value=0 )  # 位相・振幅に一定値を入れる．
        im = get_jigsaw(im, resize, grid)
        im = mask_randomly(im, resize, square_edge=20, rate=0.3)
    elif config.cuda_dir == 1:
        im = input_const_values(im, resize, const_abs=False, const_pha=True, n_random = resize[0] * resize[1] // 6, const_value=0 )  # 位相・振幅に一定値を入れる．
        im = mask_randomly(im, resize, square_edge=20, rate=0.3)
    elif config.cuda_dir == 2:
        im = get_jigsaw(im, resize, grid)
        im = mask_randomly(im, resize, square_edge=20, rate=0.3)
    elif config.cuda_dir == 3:
        im = mask_randomly(im, resize, square_edge=20, rate=0.3)
    elif config.cuda_dir == 4:
        im = get_jigsaw(im, resize, grid)
    elif config.cuda_dir == 5:
        pass
    elif config.cuda_dir == 6:
        im = input_const_values(im, resize, const_abs=False, const_pha=True, n_random = resize[0] * resize[1] // 6, const_value=0 )  # 位相・振幅に一定値を入れる．
        im = get_jigsaw(im, resize, grid)




===============================================
==============  dslr_webcam  ==============
===============================================
Please install apex for mixed precision training from: https://github.com/NVIDIA/apex
    ---------------------------------------------------------
        cuda_dir: 5
        batch_size: 256,  epochs: 100
        SSL: simclr,  base_model: encoder
        jigsaw: True,  fourier: True,  grid: 3
        num_laps: 2
    ---------------------------------------------------------
nmi:0.001377737033932962
nmi class:0.4329269268258219
domain_accuracy:0.5119876256767208
  -----  Load Model from record/Office31/CUDA5/dw_encoder__0 for clustering  -----
nmi:0.0024251265314281117
nmi class:0.43816197978002097
domain_accuracy:0.5166279969064191
  -----  Load Model from record/Office31/CUDA5/dw_encoder__0 for clustering  -----
nmi:0.0024251265314281117
nmi class:0.4312503368609089
domain_accuracy:0.5166279969064191
===============================================
nmi:0.0009192719547688576
nmi class:0.43887980848652053
domain_accuracy:0.502706883217324
  -----  Load Model from record/Office31/CUDA5/dw_encoder__1 for clustering  -----
nmi:0.0009192719547688576
nmi class:0.4322943433056199
domain_accuracy:0.502706883217324
  -----  Load Model from record/Office31/CUDA5/dw_encoder__1 for clustering  -----
nmi:0.0009192719547688576
nmi class:0.42906142920869317
domain_accuracy:0.502706883217324
===============================================
nmi:0.009505305756890856
nmi class:0.44006639810522336
domain_accuracy:0.5498839907192575
  -----  Load Model from record/Office31/CUDA5/dw_encoder__2 for clustering  -----
nmi:0.009378159152384932
nmi class:0.42758324347982324
domain_accuracy:0.5498839907192575
  -----  Load Model from record/Office31/CUDA5/dw_encoder__2 for clustering  -----
nmi:0.009505305756890856
nmi class:0.4358572601698564
domain_accuracy:0.5498839907192575



===============================================
==============  dslr_webcam  ==============
===============================================
Please install apex for mixed precision training from: https://github.com/NVIDIA/apex
    ---------------------------------------------------------
        cuda_dir: 4
        batch_size: 256,  epochs: 100
        SSL: simclr,  base_model: encoder
        jigsaw: True,  fourier: True,  grid: 3
        num_laps: 2
    ---------------------------------------------------------
nmi:0.17034573308333945
nmi class:0.3793082869071642
domain_accuracy:0.6952822892498066
  -----  Load Model from record/Office31/CUDA4/dw_encoder__0 for clustering  -----
nmi:0.03602314498000748
nmi class:0.3812533223255302
domain_accuracy:0.5808197989172468
  -----  Load Model from record/Office31/CUDA4/dw_encoder__0 for clustering  -----
nmi:0.1789241575787749
nmi class:0.37817824843020537
domain_accuracy:0.7076566125290022
===============================================
nmi:0.20585369674791842
nmi class:0.378369107575859
domain_accuracy:0.737045630317092
  -----  Load Model from record/Office31/CUDA4/dw_encoder__1 for clustering  -----
nmi:0.5953651922702424
nmi class:0.4007246817131331
domain_accuracy:0.9211136890951276
  -----  Load Model from record/Office31/CUDA4/dw_encoder__1 for clustering  -----
nmi:0.0705261382757866
nmi class:0.3931407501397286
domain_accuracy:0.6102088167053364
===============================================
nmi:0.28429424122819313
nmi class:0.3844940171129455
domain_accuracy:0.7463263727764888
  -----  Load Model from record/Office31/CUDA4/dw_encoder__2 for clustering  -----
nmi:0.12154928966316449
nmi class:0.38285778394937475
domain_accuracy:0.6403712296983759
  -----  Load Model from record/Office31/CUDA4/dw_encoder__2 for clustering  -----
nmi:0.5240618283935992
nmi class:0.3878646705788452
domain_accuracy:0.8994586233565351



===============================================
==============  dslr_webcam  ==============
===============================================
Please install apex for mixed precision training from: https://github.com/NVIDIA/apex
    ---------------------------------------------------------
        cuda_dir: 3
        batch_size: 256,  epochs: 100
        SSL: simclr,  base_model: encoder
        jigsaw: True,  fourier: True,  grid: 3
        num_laps: 2
    ---------------------------------------------------------
nmi:0.02434070745182079
nmi class:0.3933390162782036
domain_accuracy:0.5955143078112916
  -----  Load Model from record/Office31/CUDA3/dw_encoder__0 for clustering  -----
nmi:7.509342187354328e-05
nmi class:0.40368860202073104
domain_accuracy:0.5042536736272235
  -----  Load Model from record/Office31/CUDA3/dw_encoder__0 for clustering  -----
nmi:0.0033377566143942953
nmi class:0.3986198953330595
domain_accuracy:0.5204949729311679
===============================================
nmi:0.004068285801361965
nmi class:0.38365098545091075
domain_accuracy:0.525908739365816
  -----  Load Model from record/Office31/CUDA3/dw_encoder__1 for clustering  -----
nmi:0.006435256171882829
nmi class:0.3852106041047873
domain_accuracy:0.5336426914153132
  -----  Load Model from record/Office31/CUDA3/dw_encoder__1 for clustering  -----
nmi:0.0018555007801237583
nmi class:0.3825090937813012
domain_accuracy:0.5096674400618716
===============================================
nmi:0.003902493915036166
nmi class:0.3986620531647081
domain_accuracy:0.525908739365816
  -----  Load Model from record/Office31/CUDA3/dw_encoder__2 for clustering  -----
nmi:0.00338315229272404
nmi class:0.4048175092232133
domain_accuracy:0.5158546017014695
  -----  Load Model from record/Office31/CUDA3/dw_encoder__2 for clustering  -----
nmi:0.0014567386068965445
nmi class:0.39151338092790816
domain_accuracy:0.5127610208816705





===============================================
==============  dslr_webcam  ==============
===============================================
Please install apex for mixed precision training from: https://github.com/NVIDIA/apex
    ---------------------------------------------------------
        cuda_dir: 2
        batch_size: 256,  epochs: 100
        SSL: simclr,  base_model: encoder
        jigsaw: True,  fourier: True,  grid: 3
        num_laps: 2
    ---------------------------------------------------------
nmi:0.4999108663179291
nmi class:0.3702666737332123
domain_accuracy:0.8901778808971385
  -----  Load Model from record/Office31/CUDA2/dw_encoder__0 for clustering  -----
nmi:0.44867186300438755
nmi class:0.37094838785696793
domain_accuracy:0.877030162412993
  -----  Load Model from record/Office31/CUDA2/dw_encoder__0 for clustering  -----
nmi:0.6624167315780116
nmi class:0.36924768427203325
domain_accuracy:0.9396751740139211
===============================================
nmi:0.5229249260763651
nmi class:0.3610621188514089
domain_accuracy:0.8963650425367363
  -----  Load Model from record/Office31/CUDA2/dw_encoder__1 for clustering  -----
nmi:0.11819356037319305
nmi class:0.36926305545344124
domain_accuracy:0.62877030162413
  -----  Load Model from record/Office31/CUDA2/dw_encoder__1 for clustering  -----
nmi:0.13837838674756583
nmi class:0.34755441781890767
domain_accuracy:0.642691415313225
===============================================
nmi:0.5197618970735354
nmi class:0.3614138011664658
domain_accuracy:0.8979118329466358
  -----  Load Model from record/Office31/CUDA2/dw_encoder__2 for clustering  -----
nmi:0.07762678499693779
nmi class:0.36024559359445946
domain_accuracy:0.608662026295437
  -----  Load Model from record/Office31/CUDA2/dw_encoder__2 for clustering  -----
nmi:0.07736955014767607
nmi class:0.3623474784565343
domain_accuracy:0.6063418406805878









===============================================
==============  dslr_webcam  ==============
===============================================
Please install apex for mixed precision training from: https://github.com/NVIDIA/apex
    ---------------------------------------------------------
        cuda_dir: 1
        batch_size: 256,  epochs: 100
        SSL: simclr,  base_model: encoder
        jigsaw: True,  fourier: True,  grid: 3
        num_laps: 2
    ---------------------------------------------------------
nmi:0.03816798512778133
nmi class:0.36712007265304186
domain_accuracy:0.5978344934261408
  -----  Load Model from record/Office31/CUDA1/dw_encoder__0 for clustering  -----
nmi:4.031864912778177e-05
nmi class:0.3766216343982647
domain_accuracy:0.5050270688321732
  -----  Load Model from record/Office31/CUDA1/dw_encoder__0 for clustering  -----
nmi:0.01255642917400845
nmi class:0.36976992519664714
domain_accuracy:0.5537509667440061
===============================================
nmi:0.0033263444110566563
nmi class:0.3515676093000935
domain_accuracy:0.5266821345707656
  -----  Load Model from record/Office31/CUDA1/dw_encoder__1 for clustering  -----
nmi:0.0009311860418025011
nmi class:0.37112213728003596
domain_accuracy:0.5127610208816705
  -----  Load Model from record/Office31/CUDA1/dw_encoder__1 for clustering  -----
nmi:0.0038569467844956438
nmi class:0.36189967746048296
domain_accuracy:0.5290023201856149
===============================================
nmi:0.6432159679345771
nmi class:0.3582322890301797
domain_accuracy:0.9242072699149265
  -----  Load Model from record/Office31/CUDA1/dw_encoder__2 for clustering  -----
nmi:0.0005017998664847039
nmi class:0.34967046524028933
domain_accuracy:0.5011600928074246
  -----  Load Model from record/Office31/CUDA1/dw_encoder__2 for clustering  -----
nmi:0.0020064871875095334
nmi class:0.35235875056045196
domain_accuracy:0.51430781129157









===============================================
==============  dslr_webcam  ==============
===============================================
Please install apex for mixed precision training from: https://github.com/NVIDIA/apex
    ---------------------------------------------------------
        cuda_dir: 0
        batch_size: 256,  epochs: 100
        SSL: simclr,  base_model: encoder
        jigsaw: True,  fourier: True,  grid: 3
        num_laps: 2
    ---------------------------------------------------------
nmi:0.23590015950955384
nmi class:0.3496417269748996
domain_accuracy:0.7463263727764888
  -----  Load Model from record/Office31/CUDA0/dw_encoder__0 for clustering  -----
nmi:0.1447058587557593
nmi class:0.3404671246599555
domain_accuracy:0.6272235112142305
  -----  Load Model from record/Office31/CUDA0/dw_encoder__0 for clustering  -----
nmi:0.14297308324398147
nmi class:0.34766124845807955
domain_accuracy:0.6434648105181748
===============================================
nmi:0.6357877623344972
nmi class:0.34293621329985674
domain_accuracy:0.9334880123743233
  -----  Load Model from record/Office31/CUDA0/dw_encoder__1 for clustering  -----
nmi:0.46073367816730393
nmi class:0.33728680922097565
domain_accuracy:0.8754833720030936
  -----  Load Model from record/Office31/CUDA0/dw_encoder__1 for clustering  -----
nmi:0.30649892663804984
nmi class:0.3570126685104049
domain_accuracy:0.7896365042536736
===============================================
nmi:0.6357977548285961
nmi class:0.33910239407195353
domain_accuracy:0.9334880123743233
  -----  Load Model from record/Office31/CUDA0/dw_encoder__2 for clustering  -----
nmi:0.6767863850781428
nmi class:0.3367281733347458
domain_accuracy:0.9435421500386698
  -----  Load Model from record/Office31/CUDA0/dw_encoder__2 for clustering  -----
nmi:0.14728122469326915
nmi class:0.33712506047437735
domain_accuracy:0.6388244392884764





===============================================
==============  dslr_webcam  ==============
===============================================
Please install apex for mixed precision training from: https://github.com/NVIDIA/apex
    ---------------------------------------------------------
        cuda_dir: 6
        batch_size: 256,  epochs: 100
        SSL: simclr,  base_model: encoder
        jigsaw: True,  fourier: True,  grid: 3
        num_laps: 2, 
        log_dir: record/Office31/CUDA6/dw_encoder__0
    ---------------------------------------------------------
nmi:0.543309870315969
nmi class:0.3620922225219507
domain_accuracy:0.9079659706109822
  -----  Load Model from record/Office31/CUDA6/dw_encoder__0 for clustering  -----
nmi:0.5812648446682809
nmi class:0.36702162435727115
domain_accuracy:0.9187935034802784
  -----  Load Model from record/Office31/CUDA6/dw_encoder__0 for clustering  -----
nmi:0.5933426090264928
nmi class:0.36400872088964675
domain_accuracy:0.9218870843000774
===============================================
nmi:0.6134536513028933
nmi class:0.36183031945005856
domain_accuracy:0.9265274555297757
  -----  Load Model from record/Office31/CUDA6/dw_encoder__1 for clustering  -----
nmi:0.6018709270270372
nmi class:0.3728809785280059
domain_accuracy:0.9234338747099768
  -----  Load Model from record/Office31/CUDA6/dw_encoder__1 for clustering  -----
nmi:0.6617718208172887
nmi class:0.37136180414520986
domain_accuracy:0.9396751740139211
===============================================
nmi:0.42119499523068066
nmi class:0.36281595764149244
domain_accuracy:0.8638824439288476
  -----  Load Model from record/Office31/CUDA6/dw_encoder__2 for clustering  -----
nmi:0.6357977548285961
nmi class:0.362199594900897
domain_accuracy:0.9334880123743232
  -----  Load Model from record/Office31/CUDA6/dw_encoder__2 for clustering  -----
nmi:0.6092771671833844
nmi class:0.3513157896992563
domain_accuracy:0.9265274555297757